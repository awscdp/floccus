{
    "AWSTemplateFormatVersion": "2010-09-09",

    "Description": "This is auto generated cloudformation file.",

    "Resources": {
        "{{ model.vpc.value.id | replace('-','') }}" : {
            "Type" : "{{ model.vpc.typestring }}",
            "Properties" : {
                "CidrBlock" : "{{ model.vpc.value.cidr_block }}",
                "InstanceTenancy" : "{{ model.vpc.value.instanceTenancy }}"
            }
        },
{% for gateway in model.internet_gateways %}
        "{{ gateway.value.id | replace('-','') }}" : {
           "Type" : "{{ gateway.typestring }}"
        },
{% endfor %}
{% for attachment in model.gateway_attachments %}
        "{{ (attachment.value.vpc_id + attachment.gateway.value.id) | replace('-','') }}" : {
           "Type" : "{{ attachment.typestring }}",
           "Properties" : {
               "VpcId" : { "Ref" : "{{ attachment.value.vpc_id | replace('-','') }}" },
               "InternetGatewayId" : { "Ref" : "{{ attachment.gateway.value.id | replace('-','') }}" }
           }
        },
{% endfor %}
{% for subnet in model.subnets %}
        "{{ subnet.value.id | replace('-','') }}" : {
            "Type" : "{{ subnet.typestring }}",
            "Properties" : {
                "AvailabilityZone" : "{{ subnet.value.availability_zone }}",
                "CidrBlock" : "{{ subnet.value.cidr_block }}",
                "VpcId" : { "Ref" : "{{ subnet.value.vpc_id | replace('-','') }}" }
            }
        },
{% endfor -%}
{% for route_table in model.route_tables %}
        "{{ route_table.value.id | replace('-','') }}" : {
            "Type" : "{{ route_table.typestring }}",
            "Properties" : {
                "VpcId" : "{{ route_table.value.vpc_id | replace('-','') }}"
            }
        },
{% endfor -%}
{% for subnet_route_table_association in model.subnet_route_table_associations %}
{% if not subnet_route_table_association.value.main %}
        "{{subnet_route_table_association.value.id | replace('-','')}}" : {
            "Type" : "{{ subnet_route_table_association.typestring }}",
            "Properties" : {
                "RouteTableId" : { "Ref" : "{{ subnet_route_table_association.value.route_table_id | replace('-','') }}" },
                "SubnetId" : "{{ subnet_route_table_association.value.subnet_id | replace('-','') }}"
            }
        }{% if not loop.last %},{% endif %}
{% endif %}
{% endfor -%}
    }
}